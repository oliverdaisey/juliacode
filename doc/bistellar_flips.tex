\documentclass[a4paper,12pt]{article}
\author{}
\date{}
\usepackage[papersize={216mm,330mm},tmargin=20mm,bmargin=20mm,lmargin=20mm,rmargin=20mm]{geometry}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amssymb,mathabx}%\for eqref
\usepackage{lscape}
\usepackage{graphicx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{fancyhdr}
 
 \newcommand{\conv}[1]{\text{conv}(#1)}
 \newcommand{\diff}[2]{\frac{\mathrm{d}#1}{\mathrm{d}#2}}
 \newcommand{\diffs}[2]{\frac{\mathrm{d}^2#1}{\mathrm{d}#2^2}}
 \renewcommand{\d}[1]{\mathrm{d}#1}
\pagestyle{fancy}
\fancyhf{}
\chead{\thepage}
\rhead{Durham University}
\cfoot{Mathematics Notes}
\rfoot{Oliver Daisey}

\title{\LARGE \textbf{Bistellar flips algorithm} \\ \vspace{3mm} \Large \textit{Yue Ren, Oliver Daisey}}

\begin{document}
\maketitle

\section{Preliminaries}
Let us suppose we are given a list of point configurations $A_1, ..., A_m$, all of who live in $\mathbb{K}^n$. We construct the Cayley configuration $A \in \mathbb{K}^{n+m}$. Given a choice of lift $\omega \in  \mathbb{K}^{|A|}$, we obtain a polyhedral subdivision $\Delta_w$ of $\conv{A}$ by lifting each point in $A$ by the corresponding weight given by $w$, and taking the polyhedral subdivision consisting of the projection of those cells visible from below. 

A cell $\sigma \in \Delta_w$ is a \textit{mixed cell} if it has exactly two points from each $A_i$. Fixing a cell $\sigma$, we ask for all lifts $w$ that produce $\sigma$ as a mixed cell of $\Delta_w$. The Euclidean closure of this set is the \textit{mixed cell cone of $\sigma$}.

\subsection{Computing the mixed cell cone}
To compute the mixed cell cone $C_\sigma$, let $m_i$ be the number of points in $M_i$. Lemma 4.4 of Anders' paper tells us that we can use $k = \sum_i{m_i - 2}$ irredundant inequalities. To get them, look at the submatrices $A'$ of $A$ of size $2n \times (2n + 1)$ involving the $2n$ columns of the mixed cell, along with one additional column, with index $\gamma$ say. Choose non-zero $c \in \text{NullSpace(A')}$ with the condition that the entry in $c$ with index $\gamma$ is negative. Then the inequality is $w\cdot c \geq 0$. We call this choice of $c$ a \textit{circuit}. It defines a facet $F$ of $C_\sigma$.

\subsection{Bistellar flip algorithm}
Suppose we are given a mixed cell $\sigma$ of $A$. The $k$ linear inequalities defining the mixed cell cone $C_\sigma$ let us choose a generic $w \in F$ in one of their corresponding facets. The bistellar flip algorithm uses this data to take the set of all mixed cells $A_{mix}$ with respect to $w + \varepsilon c$ to the set of all mixed cells $B_{mix}$ with respect to $w - \varepsilon c$, where $\varepsilon > 0$ is sufficiently small. To do this:
\begin{enumerate}
	\item Start with empty $B_{mix}$.
	\item Let $i$ be the index of the point configuration $A_i$ which contains the additional column with index $\gamma$ defining the circuit $c$.
	\item Let $\alpha = a_i$, $\beta = b_i$.
	\item Iterate over every mixed cell $\tau$ in $A_{mix}$:
	\begin{enumerate} 
	\item If $c$ is achievable by considering the linear inequalities of the mixed cell cone $C_\tau$, then execute: \begin{enumerate}
	\item Update $B_{mix} = B_{mix} \cup \{ \tau \cup \{\gamma\} \setminus \{\alpha\} \}$ if the $\alpha$ entry of $c$ is positive.
	\item Update $B_{mix} = B_{mix} \cup \{ \tau \cup \{\gamma\} \setminus \{\beta\} \}$ if the $\beta$ entry of $c$ is positive.
	\end{enumerate}
	Note that we can update $B_{mix}$ more than once in this step.
	 \end{enumerate}
	 \item Return $B_{mix}$.
\end{enumerate}

\newpage

\subsection{Walking through the mixed cell cone}

\end{document}